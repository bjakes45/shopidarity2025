{% extends "base.html" %}
{% block title %}Product Lookup{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6 space-y-8">
  <h1 class="text-4xl font-bold text-gray-800">Product Lookup</h1>

  <!-- Search Form -->
  <form method="get" action="/products" class="flex flex-col sm:flex-row gap-4">
    <input
      type="text"
      name="query"
      placeholder="Search by UPC, Product Name, Category etc..."
      value="{{ query }}"
      class="flex-1 px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <button
      type="submit"
      class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
    >
      Search
    </button>
  </form>

  <h2 class="text-xl text-gray-700">
    Found {{ products|length }} product{{ products|length != 1 and 's' or '' }}
  </h2>

  <!-- Product List -->
<ul class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
  {% for product in display %}
    <li class="p-4 border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition bg-white">
      <h3 class="text-md font-semibold text-gray-800 truncate">
        <a href="{{ url_for('product_detail', upc=product.upc) }}" class="block text-lg font-semibold text-blue-600 hover:underline">{{ product.name[:30] }}</a>
      </h3>
      <p class="text-sm text-gray-600">UPC: {{ product.upc }}</p>
      <div class="flex justify-between text-sm text-gray-700 mt-2">
        <span>Category: {{ product.category }}</span>
        <span>Brand: {{ product.brand }}</span>
      </div>
    </li>
  {% else %}
    <li class="text-gray-500">No products found</li>
  {% endfor %}
</ul>
    <div class="flex justify-between items-center pt-4">
      {% if pagination.has_prev %}
        <a href="{{ url_for('products', page=pagination.prev_num, query=query) }}" class="text-blue-600">← Prev</a>
      {% endif %}
      <span>Page {{ pagination.page }} of {{ pagination.pages }}</span>
      {% if pagination.has_next %}
        <a href="{{ url_for('products', page=pagination.next_num, query=query) }}" class="text-blue-600">Next →</a>
      {% endif %}
    </div>
  <p class="text-sm text-gray-500">Total products in database: {{ products_all|length }}</p>
</div>
{% endblock %}
